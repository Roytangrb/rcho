(function(e){function t(t){for(var l,n,i=t[0],c=t[1],s=t[2],u=0,d=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&d.push(r[n][0]),r[n]=0;for(l in c)Object.prototype.hasOwnProperty.call(c,l)&&(e[l]=c[l]);v&&v(t);while(d.length)d.shift()();return o.push.apply(o,s||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],l=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(l=!1)}l&&(o.splice(t--,1),e=n(n.s=a[0]))}return e}var l={},r={app:0},o=[];function n(t){if(l[t])return l[t].exports;var a=l[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=l,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(a,l,function(t){return e[t]}.bind(null,l));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var v=c;o.push([1,"chunk-vendors"]),a()})({0:function(e,t){},1:function(e,t,a){e.exports=a("56d7")},"1c3d":function(e,t,a){"use strict";var l=a("f52e"),r=a.n(l);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var l=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:""},scopedSlots:e._u([{key:"extension",fn:function(){return[a("v-tabs",{attrs:{centered:""},model:{value:e.curr_tab,callback:function(t){e.curr_tab=t},expression:"curr_tab"}},[a("v-tab",{staticClass:"hidden-sm-and-down",attrs:{href:"#upload"}},[e._v(" "+e._s(e.T["upload"])+" ")]),a("v-tab",{attrs:{href:"#manual"}},[e._v(" "+e._s(e.T["manual"])+" ")])],1)]},proxy:!0}])},[a("v-toolbar-title",{staticClass:"headline text-uppercase"},[a("span",[e._v(e._s(e.T["title"]))])]),a("v-spacer"),a("v-btn-toggle",{attrs:{dense:"",tile:"",group:"",mandatory:""},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}},[a("v-btn",{attrs:{value:"CN"}},[e._v("中")]),a("v-btn",{attrs:{value:"EN"}},[e._v("EN")])],1)],1),a("v-content",[a("v-tabs-items",{attrs:{value:e.curr_tab}},[a("v-tab-item",{attrs:{value:"upload"}},[a("TableUpload",{attrs:{lang:e.lang}})],1),a("v-tab-item",{attrs:{value:"manual"}},[a("Form",{attrs:{lang:e.lang}})],1)],1)],1)],1)},o=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",md:"5"}},[a("v-select",{attrs:{label:"Template",items:e.templates,"item-text":"label","item-value":"value",clearable:!0},model:{value:e.template,callback:function(t){e.template=t},expression:"template"}}),a("v-file-input",{attrs:{label:"Click to upload",hint:e.hint_file,"prepend-icon":e.icons.excel,accept:".xlsx,.csv",disabled:!e.template,value:e.file},on:{change:e.selectFile}}),a("div",{staticClass:"drop-zone",on:{drop:function(t){return t.preventDefault(),t.stopPropagation(),e.drop(t)},dragover:function(t){t.preventDefault(),e.overlay=!0},mouseleave:function(t){e.overlay=!1}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.overlay,expression:"!overlay"}]},[a("v-icon",[e._v(e._s(e.icons.import))]),e._v(" Drop a sheet file ")],1),a("v-overlay",{attrs:{absolute:"",value:e.overlay}},[e.template?a("div",[e._v(" Upload ")]):a("div",[e._v(" Please select a template ")])])],1)],1),a("v-col",{attrs:{cols:"12",md:"7"}},[a("v-skeleton-loader",{staticClass:"mx-auto",attrs:{loading:!e.has_data,type:"table-heading, table-tbody, table-tfoot"}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.preview_data.headers,items:e.preview_data.items,"items-per-page":5}})],1)],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(" "+e._s(e.prompt_title)+" ")]),a("v-card-text",{staticClass:"mt-2"},[e._v(" "+e._s(e.prompt_content)+" ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" OK ")])],1)],1)],1)],1)},i=[],c=(a("d81d"),a("ace4"),a("b64b"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a9"),a("72f7"),a("5169")),s=a.n(c),v=a("94ed"),u={name:"TableUpload",props:["lang"],data:function(){return{hint_file:"Only accepts .xlxs .csv",templates:[{label:"酷家樂",value:"kujiale"}],template:null,file:null,overlay:!1,has_data:!1,preview_data:{headers:[],items:[]},dialog:!1,prompt_title:"",prompt_content:"",icons:{import:v["a"],excel:v["c"]}}},methods:{selectFile:function(e){var t=this;if(console.log("file picked"),!e)return t.reset();t.file=e;try{t.readFile(e)}catch(a){t.reset(),console.log(a),t.prompt("Error","Please try again.")}},drop:function(e){var t=this;if(console.log("file dropped"),!t.template)return t.prompt("Reminder","Please choose a template first."),t.reset();if(!e)return t.reset();if(!e.dataTransfer||!e.dataTransfer.files)return t.reset();var a=e.dataTransfer.files,l=a[0];if(!l)return t.reset();t.file=l;try{t.readFile(l)}catch(r){t.reset(),console.log(r),t.prompt("Error","Please try again.")}},readFile:function(e){var t=this,a=new FileReader;a.onload=function(e){var a=new Uint8Array(e.target.result),l=s.a.read(a,{type:"array"}),r=t.readSheet(l);t.preview_data=t.handleSheet(r),t.has_data=!0},a.readAsArrayBuffer(e)},readSheet:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){var a=e.SheetNames||[],l=a[t];if(l){var r=e.Sheets[l];return r}return null}},handleSheet:function(e){if(e){var t=[],a=s.a.utils.sheet_to_json(e)||[];if(a.length){var l=a[0];t=Object.keys(l),t=t.map((function(e){return{text:e,value:e}}))}return{headers:t,items:a}}},reset:function(){var e=this;e.has_data=!1,e.file=null,e.overlay=!1},prompt:function(e,t){var a=this;a.dialog=!0,a.prompt_title=e,a.prompt_content=t}}},d=u,m=(a("1c3d"),a("2877")),p=a("6544"),f=a.n(p),h=a("8336"),_=a("b0af"),b=a("99d9"),g=a("62ad"),y=a("a523"),x=a("8fea"),T=a("169a"),V=a("ce7e"),E=a("23a7"),w=a("132d"),C=a("a797"),N=a("0fd9"),k=a("b974"),M=a("3129"),O=a("2fa4"),S=Object(m["a"])(d,n,i,!1,null,"5e54e779",null),R=S.exports;f()(S,{VBtn:h["a"],VCard:_["a"],VCardActions:b["a"],VCardText:b["b"],VCardTitle:b["c"],VCol:g["a"],VContainer:y["a"],VDataTable:x["a"],VDialog:T["a"],VDivider:V["a"],VFileInput:E["a"],VIcon:w["a"],VOverlay:C["a"],VRow:N["a"],VSelect:k["a"],VSkeletonLoader:M["a"],VSpacer:O["a"]});var j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-list",e._l(e.rooms,(function(t,l){return a("v-list-item",{key:l},[a("v-list-item-content",[a("Room",{attrs:{lang:e.lang},on:{delete:e.delRoom},model:{value:e.rooms[l],callback:function(t){e.$set(e.rooms,l,t)},expression:"rooms[index]"}})],1)],1)})),1),a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{rounded:"",color:"primary",dark:""},on:{click:e.addRoom}},[e._v(e._s(e.T["add_room"]))])],1)],1)},F=[],L=(a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-list-group",{attrs:{"prepend-icon":e.icons.door,value:!0},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-title",[a("span",[e._v(e._s(e.T["room"])+": "+e._s(e.value.name||" - "))]),isNaN(e.getRoomC())?e._e():a("v-chip",{staticClass:"ma-2",attrs:{color:"primary",label:""}},[e._v(e._s(e.T["concerntration"])+": "+e._s(e.format(e.getRoomC(),4))+" mg/m³")]),e.area?a("v-chip",{staticClass:"ma-2 hidden-sm-and-down",attrs:{label:""}},[e._v(e._s(e.T["area"])+" : "+e._s(e.format(e.area))+" m²")]):e._e(),e.volume?a("v-chip",{staticClass:"ma-2 hidden-sm-and-down",attrs:{label:""}},[e._v(e._s(e.T["volume"])+": "+e._s(e.format(e.volume))+" m³")]):e._e()],1)]},proxy:!0}])},[a("v-list-item",[a("v-list-item-content",[a("div",{staticClass:"d-flex justify-space-between align-center"},[a("v-btn-toggle",{attrs:{tile:"",dense:"",color:"accent-3",mandatory:"",group:""},model:{value:e.calcType,callback:function(t){e.calcType=t},expression:"calcType"}},[a("v-btn",{attrs:{value:"rcho"}},[e._v(" "+e._s(e.T["rcho"])+" ")]),a("v-btn",{attrs:{value:"tvoc"}},[e._v(" "+e._s(e.T["tvoc"])+" ")])],1),a("v-icon",{on:{click:e.delRoom}},[e._v(e._s(e.icons.trash))])],1),a("v-form",{ref:"room-form",model:{value:e.room_valid,callback:function(t){e.room_valid=t},expression:"room_valid"}},[a("v-row",[a("v-col",[a("v-text-field",{attrs:{label:e.T["room_name"],type:"text"},model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{rules:e.num_rules,label:e.T["width"],suffix:"m",type:"number",required:""},model:{value:e.value.width,callback:function(t){e.$set(e.value,"width",t)},expression:"value.width"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{rules:e.num_rules,label:e.T["depth"],suffix:"m",type:"number",required:""},model:{value:e.value.depth,callback:function(t){e.$set(e.value,"depth",t)},expression:"value.depth"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{rules:e.num_rules,label:e.T["height"],suffix:"m",type:"number",required:""},model:{value:e.value.height,callback:function(t){e.$set(e.value,"height",t)},expression:"value.height"}})],1)],1)],1)],1)],1),e.room_valid?a("v-list-group",{attrs:{"sub-group":"",value:e.room_valid},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-title",[e._v(e._s(e.T["materials"]))]),a("v-list-item-icon",[a("v-icon",[e._v(e._s(e.icons.wall))])],1)]},proxy:!0}],null,!1,1946017347)},[e._l(e.value.items,(function(t,l){return a("v-list-item",{key:l},[a("v-list-item-content",[a("v-list-item-title",[a("span",[e._v(e._s(l+1)+" . ")]),t.material_level?a("v-chip",{staticClass:"ma-2 hidden-sm-and-down",attrs:{label:""}},[e._v(" "+e._s(e.T[e.calcType])+e._s(e.T["emi_coef"])+": "+e._s(e.getFactor(t))+"mg/m² ")]):e._e(),t.area?a("v-chip",{staticClass:"ma-2 hidden-sm-and-down",attrs:{label:""}},[e._v(e._s(e.T["share_ratio"])+": "+e._s(e.format(t.area/e.volume))+" m²/m³")]):e._e(),isNaN(e.getMaterialC(t))?e._e():a("v-chip",{staticClass:"ma-2",attrs:{label:""}},[e._v(e._s(e.T["concerntration"])+": "+e._s(e.format(e.getMaterialC(t),4))+"mg/m³")])],1),a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-select",{attrs:{label:e.T["material"],items:e.materials,"item-text":"name","item-value":"id",clearable:""},model:{value:t.material_id,callback:function(a){e.$set(t,"material_id",a)},expression:"item.material_id"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-select",{attrs:{label:e.T["material_level"],items:e.getMaterialLevels(t.material_id),"item-text":"level","item-value":"code"},model:{value:t.material_level,callback:function(a){e.$set(t,"material_level",a)},expression:"item.material_level"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-text-field",{attrs:{rules:e.num_rules,label:e.T["area"],type:"number",suffix:"m²",required:""},model:{value:t.area,callback:function(a){e.$set(t,"area",a)},expression:"item.area"}})],1)],1)],1),a("v-list-item-icon",[a("v-icon",{on:{click:function(t){return e.delMaterial(l)}}},[e._v(e._s(e.icons.trash))])],1)],1)})),a("v-list-item",[a("v-list-item-content",[a("div",{staticClass:"d-flex justify-end"},[a("v-btn",{attrs:{rounded:"",color:"secondary",dark:""},on:{click:e.addMaterial}},[e._v(e._s(e.T["add_material"]))])],1)])],1)],2):e._e()],1)}),$=[],I=(a("7db0"),a("13d5"),a("a9e3"),a("b680"),[{id:0,name:"胶合板01",levels:[{code:"E0",level:"一级",rcho:.12,tvoc:.14},{code:"E1",level:"二级",rcho:.32,tvoc:.48},{code:"E2",level:"三级",rcho:.44,tvoc:1.4},{code:"E3",level:"四级",rcho:.5,tvoc:2.08}]},{id:1,name:"密度板02",levels:[{code:"E0",level:"一级",rcho:.15,tvoc:.2},{code:"E1",level:"二级",rcho:.79,tvoc:.19},{code:"E2",level:"三级",rcho:1.24,tvoc:.37},{code:"E3",level:"四级",rcho:1.8,tvoc:.43}]},{id:2,name:"细木工板04",levels:[{code:"E0",level:"一级",rcho:.23,tvoc:.38},{code:"E1",level:"二级",rcho:.27,tvoc:.37},{code:"E2",level:"三级",rcho:.42,tvoc:.83},{code:"E3",level:"四级",rcho:.84,tvoc:.77}]},{id:3,name:"饰面木板05",levels:[{code:"E0",level:"一级",rcho:.06,tvoc:1.6},{code:"E1",level:"二级",rcho:.23,tvoc:.84},{code:"E2",level:"三级",rcho:.45,tvoc:.82},{code:"E3",level:"四级",rcho:.59,tvoc:1.55}]},{id:4,name:"刨花板06",levels:[{code:"E0",level:"一级",rcho:.16,tvoc:.32},{code:"E1",level:"二级",rcho:.34,tvoc:.5},{code:"E2",level:"三级",rcho:.48,tvoc:.66}]},{id:5,name:"木地板07",levels:[{code:"E0",level:"一级",rcho:.14,tvoc:.59},{code:"E1",level:"二级",rcho:.18,tvoc:.68},{code:"E2",level:"三级",rcho:.36,tvoc:.65}]},{id:6,name:"实木板材08",levels:[{code:"E0",level:"一级",rcho:.07,tvoc:.43},{code:"E1",level:"二级",rcho:.13,tvoc:.62},{code:"E2",level:"三级",rcho:.22,tvoc:.59}]},{id:7,name:"乳胶漆09",levels:[{code:"E0",level:"一级",rcho:.08,tvoc:.37},{code:"E1",level:"二级",rcho:.25,tvoc:.37},{code:"E2",level:"三级",rcho:.32,tvoc:.32}]},{id:8,name:"壁纸10",levels:[{code:"E0",level:"一级",rcho:.09,tvoc:.15},{code:"E1",level:"二级",rcho:.11,tvoc:.18},{code:"E2",level:"三级",rcho:.78,tvoc:1.18}]},{id:9,name:"硬包12",levels:[{code:"E0",level:"一级",rcho:.07,tvoc:.09},{code:"E1",level:"二级",rcho:.13,tvoc:.55},{code:"E2",level:"三级",rcho:.27,tvoc:1.09}]},{id:10,name:"地毯13",levels:[{code:"E0",level:"一级",rcho:.13,tvoc:.4},{code:"E1",level:"二级",rcho:.32,tvoc:.82},{code:"E2",level:"三级",rcho:.48,tvoc:.66}]}]),P=.26,A={name:"MuaualForm",props:{value:Object,lang:String},data:function(){var e={EN:{room:"Room",room_name:"Room name",width:"Width",depth:"Depth",height:"Height",area:"Area",volume:"Volume",materials:"Materials",material:"Material",add_material:"Add a material",emi_coef:" Y",share_ratio:"L",rcho:"Formaldehyde",tvoc:"TVOC",concerntration:"C",required:"Required",must_be_num:"Must be a number",invalid_num:"Invalid number"},CN:{room:"房間",room_name:"房間名稱",width:"長",depth:"寬",height:"高",area:"使用面積",volume:"體積",materials:"材料清單",material:"材料",add_material:"添加材料",emi_coef:"材料係數",share_ratio:"乘載率",rcho:"甲醛",tvoc:"TVOC",concerntration:"濃度",required:"必須填寫",must_be_num:"必須為數字",invalid_num:"錯誤數字輸入"}},t={door:v["b"],wall:v["e"],trash:v["d"]};return{room_valid:!1,translation:e,icons:t,materials:I,U:P,calcType:"rcho"}},watch:{value:{handler:function(e){this.$emit("input",e)},deep:!0}},computed:{T:function(){return this.translation[this.lang]},num_rules:function(){var e=this;return[function(t){return!!t||e.T["required"]},function(t){return!isNaN(Number(t))||e.T["must_be_num"]},function(t){return Number(t)>0||e.T["invalid_num"]}]},area:function(){return Number(this.value.width)*Number(this.value.depth)},volume:function(){return Number(this.value.width)*Number(this.value.depth)*Number(this.value.height)}},methods:{delRoom:function(){var e=this.value.id;this.$emit("delete",e)},addMaterial:function(){var e=this;e.value.items.push({material_id:null,material_level:null,area:null})},getMaterialLevels:function(e){var t=this;if(e||0===e){var a=t.materials.find((function(t){return t.id===e}))||{},l=a.levels||[];return l}return[]},getFactor:function(e){var t=this,a=t.getMaterialLevels(e.material_id),l=a.find((function(t){return t.code==e.material_level}))||{},r=l[t.calcType];return r||0===r?r:NaN},getMaterialL:function(e){var t=e.area;return t||0===t?Number(t)/this.volume:NaN},getMaterialC:function(e){var t=this,a=t.getFactor(e),l=t.getMaterialL(e),r=t.U*a*l;return isNaN(r)?NaN:r},getRoomC:function(){var e=this,t=e.value.items.reduce((function(t,a){return t+e.getMaterialC(a)}),0);return isNaN(t)||0==e.value.items.length?NaN:t},delMaterial:function(e){var t=this;t.value.items.splice(e,1)},format:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return isNaN(Number(e))?null:Number(e).toFixed(t)}}},q=A,B=a("a609"),D=a("cc20"),U=a("4bd4"),J=a("56b0"),z=a("da13"),G=a("5d23"),H=a("34c3"),K=a("8654"),W=Object(m["a"])(q,L,$,!1,null,null,null),Y=W.exports;f()(W,{VBtn:h["a"],VBtnToggle:B["a"],VChip:D["a"],VCol:g["a"],VForm:U["a"],VIcon:w["a"],VListGroup:J["a"],VListItem:z["a"],VListItemContent:G["a"],VListItemIcon:H["a"],VListItemTitle:G["b"],VRow:N["a"],VSelect:k["a"],VTextField:K["a"]});var Q={components:{Room:Y},props:["lang"],data:function(){var e={EN:{add_room:"Add a room"},CN:{add_room:"添加房間"}};return{rooms:[],translation:e}},mounted:function(){var e=this;e.addRoom()},computed:{T:function(){return this.translation[this.lang]}},methods:{addRoom:function(){var e=this,t=e.rooms.length;e.rooms.push({id:t,name:null,width:null,depth:null,height:null,items:[]})},delRoom:function(e){var t=this;t.rooms.splice(e,1)}}},X=Q,Z=a("8860"),ee=Object(m["a"])(X,j,F,!1,null,null,null),te=ee.exports;f()(ee,{VBtn:h["a"],VContainer:y["a"],VList:Z["a"],VListItem:z["a"],VListItemContent:G["a"]});var ae={name:"App",components:{TableUpload:R,Form:te},computed:{T:function(){return this.translation[this.lang]}},data:function(){var e={EN:{title:"Coming Soon...",upload:"Read Excel",manual:"Manual"},CN:{title:"醛威計算器",upload:"讀取試算表",manual:"輸入計算"}};return{lang:"CN",curr_tab:"manual",translation:e}},methods:{}},le=ae,re=a("7496"),oe=a("40dc"),ne=a("a75b"),ie=a("71a3"),ce=a("c671"),se=a("fe57"),ve=a("aac8"),ue=a("2a7f"),de=Object(m["a"])(le,r,o,!1,null,null,null),me=de.exports;f()(de,{VApp:re["a"],VAppBar:oe["a"],VBtn:h["a"],VBtnToggle:B["a"],VContent:ne["a"],VSpacer:O["a"],VTab:ie["a"],VTabItem:ce["a"],VTabs:se["a"],VTabsItems:ve["a"],VToolbarTitle:ue["a"]});var pe=a("f309");l["a"].use(pe["a"]);var fe=new pe["a"]({icons:{iconfont:"mdiSvg"}});l["a"].config.productionTip=!1,new l["a"]({vuetify:fe,render:function(e){return e(me)}}).$mount("#app")},f52e:function(e,t,a){}});
//# sourceMappingURL=app.8102b731.js.map